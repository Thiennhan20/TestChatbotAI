<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Fancy ChatBot</title>

	<!-- Bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

	<!-- Markdown Parser -->
	<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

	<!-- Highlight.js for code block -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
	<script>hljs.highlightAll();</script>

	<style>
		body {
			background: linear-gradient(135deg, #667eea, #764ba2);
			min-height: 100vh;
			color: #fff;
			display: flex;
			align-items: center;
			justify-content: center;
			font-family: 'Segoe UI', sans-serif;
		}
		.chat-container {
			width: 100%;
			max-width: 650px;
			background: #fff;
			border-radius: 15px;
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
			overflow: hidden;
			color: #000;
		}
		.chat-header {
			background: #5a67d8;
			padding: 15px;
			color: #fff;
			text-align: center;
			font-size: 1.4rem;
			font-weight: bold;
		}
		.chat-messages {
			height: 450px;
			overflow-y: auto;
			padding: 20px;
			background-color: #f7f9fc;
		}
		.message {
			display: flex;
			margin-bottom: 15px;
			align-items: flex-start;
		}
		.message.bot .bubble {
			background: #e2e8f0;
			color: #1a202c;
			border-radius: 15px 15px 15px 0;
		}
		.message.user .bubble {
			background: #5a67d8;
			color: #fff;
			border-radius: 15px 15px 0 15px;
			margin-left: auto;
		}
		.bubble {
			padding: 10px 15px;
			max-width: 75%;
			word-wrap: break-word;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		}
		.chat-input {
			display: flex;
			border-top: 1px solid #ccc;
			padding: 10px;
		}
		.chat-input input {
			flex: 1;
			border: none;
			padding: 10px;
			border-radius: 10px;
			margin-right: 10px;
			background: #edf2f7;
		}
		.chat-input button {
			background: #5a67d8;
			color: white;
			border: none;
			padding: 10px 20px;
			border-radius: 10px;
			cursor: pointer;
		}
		.avatar {
			width: 32px;
			height: 32px;
			border-radius: 50%;
			margin-right: 10px;
			margin-top: 5px;
		}
		.typing-indicator {
			font-style: italic;
			color: #888;
			font-size: 0.9em;
			margin-left: 10px;
		}

		/* Markdown Styling */
		#chatBox .bubble h1, 
		#chatBox .bubble h2, 
		#chatBox .bubble h3 {
			color: #2d3748;
			margin-bottom: 0.5rem;
			font-weight: bold;
		}
		#chatBox .bubble p {
			margin-bottom: 0.5rem;
		}
		#chatBox .bubble code {
			background: #f1f1f1;
			color: #c7254e;
			padding: 2px 5px;
			border-radius: 4px;
			font-family: monospace;
		}
		#chatBox .bubble pre {
			background: #f7f7f7;
			padding: 10px;
			border-radius: 8px;
			overflow-x: auto;
		}
		#chatBox .bubble pre code {
			background: transparent;
			color: #333;
			padding: 0;
		}
		#chatBox .bubble ul {
			padding-left: 20px;
			margin-bottom: 1rem;
		}
		#chatBox .bubble li {
			margin-bottom: 5px;
		}
	</style>
</head>
<body>
	<div class="chat-container">
		<div class="chat-header">ðŸ’¬ Fancy ChatBot</div>
		<div class="chat-messages" id="chatBox"></div>
		<div class="chat-input">
			<input type="text" id="userInput" placeholder="Type your message..." />
			<button onclick="sendMessage()">Send</button>
		</div>
	</div>

	<script>
		const chatBox = document.getElementById('chatBox');

		marked.setOptions({
			highlight: function (code, lang) {
				return hljs.highlightAuto(code, [lang]).value;
			}
		});

		function addMessage(content, sender = 'bot') {
			const messageEl = document.createElement('div');
			messageEl.className = `message ${sender}`;
			const avatarSrc =
				sender === 'user'
					? 'https://i.pravatar.cc/32?img=3'
					: 'https://cdn-icons-png.flaticon.com/512/4712/4712109.png';
			messageEl.innerHTML = `
				<img src="${avatarSrc}" class="avatar" />
				<div class="bubble">${marked.parse(content)}</div>
			`;
			chatBox.appendChild(messageEl);
			chatBox.scrollTop = chatBox.scrollHeight;
			hljs.highlightAll();
		}

		function showTyping() {
			const typing = document.createElement('div');
			typing.id = 'typing';
			typing.className = 'message bot';
			typing.innerHTML = `
				<img src="https://cdn-icons-png.flaticon.com/512/4712/4712109.png" class="avatar" />
				<div class="bubble typing-indicator">Typing...</div>
			`;
			chatBox.appendChild(typing);
			chatBox.scrollTop = chatBox.scrollHeight;
		}

		function removeTyping() {
			const typing = document.getElementById('typing');
			if (typing) typing.remove();
		}

		async function sendMessage() {
			const input = document.getElementById('userInput');
			const text = input.value.trim();
			if (!text) return;
			addMessage(text, 'user');
			input.value = '';
			showTyping();

			try {
				const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
					method: 'POST',
					headers: {
						Authorization: 'Bearer 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',
						'HTTP-Referer': 'https://next-js-firm.vercel.app',
						'X-Title': 'Firm',
						'Content-Type': 'application/json',
					},
					body: JSON.stringify({
						model: 'x-ai/grok-4.1-fast:free',
						messages: [{ role: 'user', content: text }],
					}),
				});
				const data = await response.json();
				removeTyping();
				const message = data.choices?.[0]?.message?.content || 'No response received.';
				addMessage(message, 'bot');
			} catch (err) {
				removeTyping();
				addMessage('Error: ' + err.message, 'bot');
			}
		}
	</script>
</body>
</html>
